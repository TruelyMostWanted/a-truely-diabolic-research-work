graph TD
    %% === Style Definitions ===
    classDef entity fill:#cde,stroke:#333,stroke-width:2px;
    classDef attribute fill:#fff,stroke:#666,stroke-width:1px,color:#333;
    classDef relation fill:#f9d,stroke:#c69,stroke-width:1px;
    classDef goal fill:#dfd,stroke:#5a5,stroke-width:2px;
    classDef condition fill:#fdd,stroke:#a55,stroke-width:2px;
    classDef dv fill:#eef,stroke:#55a,stroke-width:2px;

    subgraph "Legend"
        direction LR
        LE[Entity]
        LA[Attribute]
        LR[Relationship]
        LG[Goal]
        LC[Condition]
        LDV[Decision Variable]
        class LE entity;
        class LA attribute;
        class LR relation;
        class LG goal;
        class LC condition;
        class LDV dv;
    end

    subgraph "Core Entities & Relationships"
        %% Entities
        E0[E0 Project]; E1[E1 Team]; E2[E2 Worker]; E3[E3 Feature]; E4[E4 Skill]; E5[E5 Role]; E6[E6 ProductOwner]; E7[E7 ScrumMaster]; E8[E8 ProductBacklog]; E9[E9 Sprint]; E10[E10 SprintPlanning]; E11[E11 DailyScrum]; E12[E12 SprintReview]; E13[E13 SprintRetrospective]; E14[E14 SprintBacklog]; E15[E15 SprintGoal]; E16[E16 Epic]; E17[E17 UserStory]; E18[E18 Task]; E19[E19 DevelopmentSnapshot]; E20[E20 Blocker]; E21[E21 Stakeholder]; E22[E22 Velocity]; E23[E23 ReleasePlan]; E24[E24 Roadmap]; E25[E25 ScrumBoard]; E26[E26 FeatureDocumentation];

        %% Relationships
        E1 -- R1 is_assigned_to_project --- E0;
        E2 -- R2 belongs_to_team --- E1;
        E2 -- R3 has_skill --- E4;
        E2 -- R4 takes_on_role --- E5;
        E6 -- R5 manages_backlog --- E8;
        E1 -- R6 is_supported_by --- E7;
        E8 -- R7 contains_feature --- E3;
        E8 -- R8 contains_epic --- E16;
        E16 -- R9 contains_user_story --- E17;
        E17 -- R10 consists_of_tasks --- E18;
        E17 -- R11 is_in_sprint_backlog --- E14;
        E14 -- R12 belongs_to_sprint --- E9;
        E9 -- R13 pursues_goal --- E15;
        E25 -- R14 contains_tasks --- E18;
        E26 -- R15 documents_feature --- E3;
        E18 -- R16 is_blocked_by --- E20;
        E21 -- R17 participates_in --- E12;
        E7 -- R18 moderates_retrospective --- E13;
        E22 -- R19 refers_to_team --- E1;
        E23 -- R20 plans_release --- E3;
        E23 -- R21 is_part_of_roadmap --- E24;
        E9 -- R22 generates_snapshot --- E19;
    end

    subgraph "Attributes"
        %% Project Attributes
        E0_attr_priority(priority); E0_attr_budget(budget); E0_attr_status(status);
        E0 --- E0_attr_priority; E0 --- E0_attr_budget; E0 --- E0_attr_status;

        %% Team Attributes
        E1_attr_team_size(team_size); E1 --- E1_attr_team_size;

        %% Worker Attributes
        E2_attr_status(status); E2_attr_availability(availability);
        E2 --- E2_attr_status; E2 --- E2_attr_availability;

        %% Feature Attributes
        E3_attr_priority(priority); E3_attr_effort(estimated_effort);
        E3 --- E3_attr_priority; E3 --- E3_attr_effort;

        %% Retrospective Attributes
        E13_attr_satisfaction(team_satisfaction); E13 --- E13_attr_satisfaction;

        %% Epic Attributes
        E16_attr_priority(priority); E16 --- E16_attr_priority;

        %% UserStory Attributes
        E17_attr_story_points(story_points); E17 --- E17_attr_story_points;

        %% Task Attributes
        E18_attr_effort(effort); E18 --- E18_attr_effort;

        %% Blocker Attributes
        E20_attr_severity(severity); E20_attr_status(status);
        E20 --- E20_attr_severity; E20 --- E20_attr_status;

        %% Stakeholder Attributes
        E21_attr_influence(influence_level); E21 --- E21_attr_influence;

        %% Velocity Attributes
        E22_attr_velocity(avg._story_points); E22 --- E22_attr_velocity;
    end

    subgraph "Goals (Green)"
        G0[G0 maximize_project_priority]; G1[G1 maximize_feature_priority]; G2[G2 maximize_story_points_in_sprint]; G3[G3 maximize_team_satisfaction]; G4[G4 minimize_task_effort]; G5[G5 maximize_stakeholder_influence]; G6[G6 maximize_team_velocity]; G7[G7 minimize_blocker_severity]; G8[G8 maximize_budget_utilization]; G9[G9 maximize_epic_priority]; G10[G10 maximize_worker_availability]; G11[G11 minimize_effort_for_high_priority_features];

        %% Goal Connections
        G0 --> E0_attr_priority;
        G1 --> E3_attr_priority;
        G2 --> E17_attr_story_points;
        G3 --> E13_attr_satisfaction;
        G4 --> E18_attr_effort;
        G5 --> E21_attr_influence;
        G6 --> E22_attr_velocity;
        G7 --> E20_attr_severity;
        G8 --> E0_attr_budget;
        G9 --> E16_attr_priority;
        G10 --> E2_attr_availability;
        G11 --> E3_attr_effort;
    end

    subgraph "Conditions (Red)"
        C0[C0 worker_status_active]; C1[C1 project_status_not_completed]; C2[C2 team_size_limit]; C3[C3 task_effort_is_positive]; C4[C4 sprint_capacity_check]; C5[C5 blocker_status_is_open]; C6[C6 worker_availability]; C7[C7 budget_is_positive];

        %% Condition Connections
        C0 --> E2_attr_status;
        C1 --> E0_attr_status;
        C2 --> E1_attr_team_size;
        C3 --> E18_attr_effort;
        C4 --> E17_attr_story_points; C4 --> E22;
        C5 --> E20_attr_status;
        C6 --> E2_attr_availability; C6 --> E18_attr_effort;
        C7 --> E0_attr_budget;
    end

    subgraph "Decision Variables (Purple)"
        DV0[DV0 assign_worker_to_team]; DV1[DV1 assign_team_to_project]; DV2[DV2 assign_user_story_to_sprint]; DV3[DV3 select_feature_for_release]; DV4[DV4 assign_task_to_worker]; DV5[DV5 start_project]; DV6[DV6 resolve_blocker];

        %% DV Connections
        DV0 -- connects --- E2; DV0 -- connects --- E1;
        DV1 -- connects --- E1; DV1 -- connects --- E0;
        DV2 -- connects --- E17; DV2 -- connects --- E9;
        DV3 -- connects --- E3; DV3 -- connects --- E23;
        DV4 -- connects --- E18; DV4 -- connects --- E2;
        DV5 -- decision_for --- E0;
        DV6 -- decision_for --- E20;
    end

    %% === Apply All Class Definitions ===
    class E0,E1,E2,E3,E4,E5,E6,E7,E8,E9,E10,E11,E12,E13,E14,E15,E16,E17,E18,E19,E20,E21,E22,E23,E24,E25,E26 entity;
    class E0_attr_priority,E0_attr_budget,E0_attr_status,E1_attr_team_size,E2_attr_status,E2_attr_availability,E3_attr_priority,E3_attr_effort,E13_attr_satisfaction,E16_attr_priority,E17_attr_story_points,E18_attr_effort,E20_attr_severity,E20_attr_status,E21_attr_influence,E22_attr_velocity attribute;
    class G0,G1,G2,G3,G4,G5,G6,G7,G8,G9,G10,G11 goal;
    class C0,C1,C2,C3,C4,C5,C6,C7 condition;
    class DV0,DV1,DV2,DV3,DV4,DV5,DV6 dv;